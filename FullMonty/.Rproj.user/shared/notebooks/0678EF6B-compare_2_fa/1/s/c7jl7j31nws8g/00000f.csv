"0",""
"0","    my_plot_chart <- function(pv, "
"0","                              title = ""auto"", "
"0","                              zoom_radius, zoom_centre,"
"0","                              breaks = NULL) {"
"0","    #png(filename =  paste(label,""_chart.png"",sep=""""),"
"0","        #width = 700, height = 700, units = ""px"") #, pointsize = 12,"
"0","     #bg = ""white"",  res = NA, ...,"
"0","    #type = c(""cairo"", ""cairo-png"", ""Xlib"", ""quartz""), antialias)"
"0","    #plot_field(pv ,breaks=c(0,0.03,0.06,0.09,0.12,0.15,0.18,0.21) )"
"0","    if (zoom_radius == 0){"
"0","	    plot_field(pv,title=title, breaks = breaks)"
"0","    } else {"
"0","            plot_field(pv,zoom_centre=zoom_centre, zoom_radius=zoom_radius,"
"0","	    title={{title}})}"
"0",""
"0","    #dev.off()"
"0","    #print(paste(""created "", paste(label,""_chart.png"",sep="""")))"
"0","    }"
"0",""
"0",""
"0",""
"0",""
"0",""
"0","    my_plot_histo <- function(pv,label,zoom_radius,lonc,latc){"
"0","    # Deal with sub-domain:"
"0","    if (zoom_radius == 0){ "
"0","	hisvar <- pv"
"0","    } else {         "
"0","        zc <- round(meteogrid::point.index(pv, lonc,latc))"
"0","        ix1 <- zc$i-zoom_radius"
"0","        ix2 <- zc$i+zoom_radius"
"0","        jy1 <- zc$j-zoom_radius"
"0","        jy2 <- zc$j+zoom_radius"
"0","	hisvar <- pv[ix1:ix2,jy1:jy2] "
"0","    }"
"0","    #png(paste(label,""_histo.png"",sep=""""))"
"0","    #title <- paste("
"0","    #  attr(T2M[[i]],""info"")$name,"
"0","    #  ""\n"","
"0","    #  format(attr(T2M[[i]], ""info"")$time$basedate, ""%H:%M %d %b %Y""),"
"0","    #  ""+"","
"0","    #  paste0("
"0","    #    attr(T2M[[i]],""info"")$time$leadtime, attr(T2M[[i]],""info"")$time$stepUnit"
"0","    #  )"
"0","    #  )"
"0","    hisdat <- data.frame(values = c(as.vector(hisvar)))"
"0","  "
"0","    histo <- ggplot(hisdat, aes(x = values)) + "
"0","           geom_histogram(position = ""identity"", alpha = 0.2, bins = 50) +"
"0","      scale_y_log10() +"
"0","      ggtitle(label)"
"0","    #hist(T2M[[i]],col='lightcyan',main=title)"
"0","    print(histo)"
"0","    #print(paste(""created "",paste(label,""_histo.png"",sep=""""), sep=""""))"
"0","		#dev.off()"
"0","     }"
"0","    "
"0","    "
"0","    my_plot_histo2 <- function(pv1,pv2,label_1,label_2,zoom_radius,lonc,latc){"
"0","    # Deal with sub-domain:"
"0","    if (zoom_radius == 0){ "
"0","	hisvar_1 <- pv1"
"0","	hisvar_2 <- pv2}"
"0","    else {         "
"0","        zc <- round(meteogrid::point.index(P1, lonc,latc))"
"0","        ix1 <- zc$i-zoom_radius"
"0","        ix2 <- zc$i+zoom_radius"
"0","        jy1 <- zc$j-zoom_radius"
"0","        jy2 <- zc$j+zoom_radius"
"0","	hisvar_1 <- pv1[ix1:ix2,jy1:jy2] "
"0","	hisvar_2 <- pv2[ix1:ix2,jy1:jy2] }"
"0"," "
"0","    #png(paste(paste(label_1,label_2,sep=""&""),""_histo.png"",sep=""""))"
"0","    #title <- paste("
"0","    #  attr(T2M[[i]],""info"")$name,"
"0","    #  ""\n"","
"0","    #  format(attr(T2M[[i]], ""info"")$time$basedate, ""%H:%M %d %b %Y""),"
"0","    #  ""+"","
"0","    #  paste0("
"0","    #    attr(T2M[[i]],""info"")$time$leadtime, attr(T2M[[i]],""info"")$time$stepUnit"
"0","    #  )"
"0","    #  )"
"0","    hisdat <- data.frame(values = c(as.vector(hisvar_1),as.vector(hisvar_2)),"
"0","                          group = c(rep(paste(trimws(attr(P1,""info"")$name),""1"",sep=""_""),length(hisvar_1)),"
"0","			            rep(paste(trimws(attr(P2,""info"")$name),""2"",sep=""_""),length(hisvar_2) )))"
"0",""
"0","    print(length(hisvar_1))"
"0","    print(length(hisvar_2))"
"0","    histo <- ggplot(hisdat, aes(x = values, fill = group)) +  # Draw overlaying histogram"
"0","             geom_histogram(position = ""identity"", alpha = 0.2, bins = 50) +"
"0","             scale_y_log10()"
"0","    print(histo)"
"0","    #print(paste(""created "",paste(label_1,label_2,sep=""&""),""_histo.png"",sep=""""))"
"0","    #dev.off()"
"0","    }"
"0","    "
"0","    "
"0","    my_plot_cumhisto2 <- function(pv1,pv2,label_1,label_2,zoom_radius,lonc,latc){"
"0","    # Deal with sub-domain:"
"0","    if (zoom_radius == 0){ "
"0","	hisvar_1 <- as.vector(pv1)"
"0","	hisvar_2 <- as.vector(pv2)"
"0","	}  else {         "
"0","        zc <- round(meteogrid::point.index(P1, lonc,latc))"
"0","        ix1 <- zc$i-zoom_radius"
"0","        ix2 <- zc$i+zoom_radius"
"0","        jy1 <- zc$j-zoom_radius"
"0","        jy2 <- zc$j+zoom_radius"
"0","	      hisvar_1 <- as.vector(pv1[ix1:ix2,jy1:jy2]) "
"0","	      hisvar_2 <- as.vector(pv2[ix1:ix2,jy1:jy2]) "
"0","	}"
"0","      "
"0","  hisvar_1 <- hisvar_1[!is.nan(hisvar_1) & !is.na(hisvar_1)]"
"0","  hisvar_2 <- hisvar_2[!is.nan(hisvar_2) & !is.na(hisvar_2)]"
"0",""
"0","   "
"0","  # Create data frames with cumulative frequencies for both vectors"
"0"," df1 <- data.frame(x = sort(hisvar_1), cum_freq = seq_along(hisvar_1) / length(hisvar_1))"
"0"," df2 <- data.frame(x = sort(hisvar_2), cum_freq = seq_along(hisvar_2) / length(hisvar_2))"
"0",""
"0","# Combine data frames"
"0","df_combined <- rbind(transform(df1, vector = ""hisvar_1""), transform(df2, vector = ""hisvar_2""))"
"0",""
"0","# Plot the cumulative distribution functions using geom_step"
"0","  cumhisto <- ggplot(df_combined, aes(x = x, y = cum_freq, color = vector)) +"
"0","  geom_step() +"
"0","  labs(x = ""Data"", y = ""Cumulative Frequency"", title = ""Cumulative Distribution Functions"") +"
"0","  scale_color_manual(values = c(""hisvar_1"" = ""blue"", ""hisvar_2"" = ""red"")) #+"
"0","  #scale_x_log10()"
"0","  print(cumhisto)   "
"0","   "
"0","     }"
"0",""
"0","    my_plot_histo2 <- function(pv1,pv2,label_1,label_2,zoom_radius,lonc,latc){"
"0","    # Deal with sub-domain:"
"0","    if (zoom_radius == 0){ "
"0","	hisvar_1 <- pv1"
"0","	hisvar_2 <- pv2}"
"0","    else {         "
"0","        zc <- round(meteogrid::point.index(P1, lonc,latc))"
"0","        ix1 <- zc$i-zoom_radius"
"0","        ix2 <- zc$i+zoom_radius"
"0","        jy1 <- zc$j-zoom_radius"
"0","        jy2 <- zc$j+zoom_radius"
"0","	hisvar_1 <- pv1[ix1:ix2,jy1:jy2] "
"0","	hisvar_2 <- pv2[ix1:ix2,jy1:jy2] }"
"0"," "
"0","    #png(paste(paste(label_1,label_2,sep=""&""),""_histo.png"",sep=""""))"
"0","    #title <- paste("
"0","    #  attr(T2M[[i]],""info"")$name,"
"0","    #  ""\n"","
"0","    #  format(attr(T2M[[i]], ""info"")$time$basedate, ""%H:%M %d %b %Y""),"
"0","    #  ""+"","
"0","    #  paste0("
"0","    #    attr(T2M[[i]],""info"")$time$leadtime, attr(T2M[[i]],""info"")$time$stepUnit"
"0","    #  )"
"0","    #  )"
"0","    hisdat <- data.frame(values = c(as.vector(hisvar_1),as.vector(hisvar_2)),"
"0","                          group = c(rep(paste(trimws(attr(P1,""info"")$name),""1"",sep=""_""),length(hisvar_1)),"
"0","			            rep(paste(trimws(attr(P2,""info"")$name),""2"",sep=""_""),length(hisvar_2) )))"
"0",""
"0","    print(length(hisvar_1))"
"0","    print(length(hisvar_2))"
"0","    histo <- ggplot(hisdat, aes(x = values, fill = group)) +                       # Draw overlaying histogram"
"0","             geom_histogram(position = ""identity"", alpha = 0.2, bins = 50) "
"0","          #+scale_y_log10()"
"0","    #hist(T2M[[i]],col='lightcyan',main=title)"
"0","    print(histo)"
"0","    #print(paste(""created "",paste(label_1,label_2,sep=""&""),""_histo.png"",sep=""""))"
"0","    #dev.off()"
"0","     }"
"0",""
"0",""
"0","    my_plot_scatter <- function(pv1,pv2,label_1,label_2,zoom_radius,lonc,latc){"
"0","    # Deal with sub-domain:"
"0","    if (zoom_radius == 0){ "
"0","	hisvar_1 <- pv1"
"0","	hisvar_2 <- pv2}"
"0","    else {         "
"0","        zc <- round(meteogrid::point.index(P1, lonc,latc))"
"0","        ix1 <- zc$i-zoom_radius"
"0","        ix2 <- zc$i+zoom_radius"
"0","        jy1 <- zc$j-zoom_radius"
"0","        jy2 <- zc$j+zoom_radius"
"0","	hisvar_1 <- pv1[ix1:ix2,jy1:jy2] "
"0","	hisvar_2 <- pv2[ix1:ix2,jy1:jy2] }"
"0",""
"0","    #png(paste(paste(label_1,label_2,sep=""&""),""_scatter.png"",sep=""""))"
"0","    # title <- paste("
"0","    #   ""T2M\n"","
"0","    #   format(attr(T2M[[1]], ""info"")$time$basedate, ""%H:%M %d %b %Y""),"
"0","    #   ""+"","
"0","    #   paste0("
"0","    #     attr(T2M[[1]],""info"")$time$leadtime, attr(T2M[[1]],""info"")$time$stepUnit"
"0","    #   ))"
"0","    scatter <- ggplot(data=NULL, aes(x = as.vector(hisvar_1), y = as.vector(hisvar_2))) +"
"0","    geom_hex(position = ""identity"")       +"
"0","        scale_fill_viridis_c("
"0","          option = ""magma"", "
"0","          name   = ""Frequency"", "
"0","          trans  = ""log"","
"0","          breaks = seq_double(1, 20),"
"0","          labels = function(x) format(x, scientific = FALSE,"
"0","                                      trim = TRUE),"
"0","        ) +"
"0","        geom_abline(intercept = 0, slope = 1, color = ""black"", linetype = ""solid"") +"
"0","        labs(x = ""P1"", "
"0","             y = ""P2"" "
"0","             #title =  paste("
"0","               #plotvar,"" at "",site,""\n"","
"0","               #days, "" days present in "", start_date,"" - "",end_date,sep="""")"
"0","        )"
"0",""
"0",""
"0",""
"0","  print(scatter)"
"0","  print(paste(""created "",paste(label_1,label_2,sep=""vs""),""_scatter.png"",sep=""""))"
"0","  #dev.off()"
"0","    }"
